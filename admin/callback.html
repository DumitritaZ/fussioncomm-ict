<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Authenticating…</title>
  </head>
  <body>
    <script>
      // Decap/Netlify CMS GitHub OAuth callback helper
      (function() {
        function getParam(name) {
          const m = window.location.search.match(new RegExp('[?&]'+name+'=([^&]+)'));
          return m ? decodeURIComponent(m[1]) : null;
        }
        // Store the oauth token in localStorage, CMS îl citește automat
        var token = getParam('token') || getParam('access_token') || getParam('code');
        if (token) {
          try { window.localStorage.setItem('netlify-cms-oauth2', token); } catch(e){}
        }
        // Închide fereastra popup și revino în /admin
        if (window.opener && window.opener.location) {
          window.opener.location.reload();
          window.close();
        } else {
          window.location.href = '/admin/';
        }
      })();
    </script>
    Authenticating…
  </body>
</html>
